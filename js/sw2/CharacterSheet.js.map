{"version":3,"sources":["sw2/CharacterSheet.jsx"],"names":[],"mappings":"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","file":"sw2/CharacterSheet.js","sourcesContent":["'use strict';\r\n\r\nvar axios = require('axios');\r\nvar hash = require('../hash');\r\nvar Character = require('./Character');\r\nvar Skill = require('./Skill');\r\n\r\nmodule.exports = React.createClass({\r\n    getInitialState: function () {\r\n        return {data: []};\r\n    },\r\n    componentDidMount: function () {\r\n        axios.get(this.props.url).then(function (response) {\r\n            this.setState({\r\n                data: response.data\r\n            });\r\n        }.bind(this));\r\n    },\r\n    handleChange: function (key, newValue) {\r\n        console.log(key + ': ' + hash.get(this.state.data, key) + ' -> ' + newValue);\r\n        hash.set(this.state.data, key, newValue);\r\n        this.forceUpdate();\r\n    },\r\n    calculate: function () {\r\n        var data = this.state.data;\r\n\r\n        // Correct\r\n        data.corrects = [0, 0, 0, 0, 0, 0];\r\n\r\n        // Ability\r\n        data.sums = [];\r\n        data.growth_count = 0;\r\n        for (var i = 0; i < 6; ++i) {\r\n            data.sums[i] = data[['skill', 'skill', 'body', 'body', 'mind', 'mind'][i]]\r\n                + (data.abilities || [])[i]\r\n                + (data.growths || [])[i]\r\n                + (data.corrects || [])[i];\r\n            if (data.growths) {\r\n                data.growth_count += data.growths[i];\r\n            }\r\n        }\r\n        data.bonuses = data.sums.map(function (n) {\r\n            return Math.floor(n / 6);\r\n        });\r\n\r\n        // Level\r\n        if (data.skills) {\r\n            data.level = data.skills.map(function (skill) {\r\n                return skill.level;\r\n            }).reduce(function (a, b) {\r\n                return (a > b) ? a : b;\r\n            });\r\n        }\r\n\r\n        // Skill\r\n        if (data.skills) {\r\n            data.skills.forEach(function (skill) {\r\n                var magic_power = Skill.magicPower(skill.name, +skill.level, data) + (data.magic_power || 0);\r\n                if (magic_power) {\r\n                    skill.magic_power = magic_power;\r\n                }\r\n\r\n                skill.next = Skill.next(skill.name, +skill.level);\r\n                skill.total = Skill.total(skill.name, +skill.level);\r\n            });\r\n            data.total_experience = data.skills.map(function (skill) {\r\n                return +skill.total;\r\n            }).reduce(function (a, b) {\r\n                return a + b;\r\n            });\r\n        }\r\n\r\n        // Protection, Evasion\r\n        data.protection = 0;\r\n        data.evasion = 0;\r\n        if (data.armor) {\r\n            data.protection += (+data.armor.protection) || 0;\r\n            data.evasion += (+data.armor.evasion) || 0;\r\n        }\r\n        if (data.shield) {\r\n            data.protection += (+data.shield.protection) || 0;\r\n            data.evasion += (+data.shield.evasion) || 0;\r\n        }\r\n        if (data.skills) {\r\n            data.evasion += Skill.base(+(data.skills.find(function (skill) {\r\n                return skill.name == data.evasion_skill;\r\n            }) || {level: 0}).level, data.bonuses[1]);\r\n        }\r\n    },\r\n    render: function () {\r\n        this.calculate();\r\n        return (\r\n            <div className=\"sw2-character-sheet\">\r\n                <header>\r\n                    <h1><a href=\"#\">{this.state.data.user_id}</a> / <a href=\"#\">{this.state.data.name}</a></h1>\r\n                    \r\n                </header>\r\n                <Character data={this.state.data} onChange={this.handleChange}/>\r\n            </div>\r\n        );\r\n    }\r\n});\r\n"],"sourceRoot":"/source/"}